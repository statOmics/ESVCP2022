<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement" />


<title>2. Rank Tests</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ESVCP Pre-Congress Session</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01-intro.html">01-Intro</a>
    </li>
    <li>
      <a href="02-ranktests.html">02-Rank Tests</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/ESVCP22">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">2. Rank Tests</h1>
<h4 class="author">Lieven Clement</h4>
<h4 class="date">statOmics, Ghent University (<a href="https://statomics.github.io" class="uri">https://statomics.github.io</a>)</h4>

</div>


<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>Inference was only correct if distributional assumptions were satisfied</p>
<ul>
<li><p>e.g Normal distribution</p></li>
<li><p>equal variance</p></li>
<li><p>The <span class="math inline">\(p\)</span>-value: <span class="math inline">\(\text{P}_0\left[ \vert T\vert \geq \vert t \vert \right]\)</span>.</p>
<ul>
<li>Calculated using the null distribution of <span class="math inline">\(T\)</span> that we derived under the assumptions</li>
<li>In correct if assumptions are violated</li>
</ul></li>
<li><p><span class="math inline">\(95\%\)</span> CI also builds upon these assumptions. If they are invalid then the intervals will not contain the population parameter with 95% probability.</p></li>
<li><p>Asymptotic theory is more difficult to place: the <span class="math inline">\(t\)</span>-test is asymptotically non-parametric because for very large samples the distributional assumptions of normality are no longer important.</p></li>
<li><p>If assumptions hold the parametric approach</p>
<ul>
<li>more efficient: larger power with same sample size + smaller CI.</li>
<li>more flexible: easier to analyse data with complex designs</li>
</ul></li>
</ul>
<hr />
<div id="cholesterol-example" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Cholesterol example</h2>
<ul>
<li>Cholesterol concentration in blood measured for
<ul>
<li>5 patients (group=1) two days upon a stroke</li>
<li>5 healthy subject (groep=2).</li>
</ul></li>
<li>Is cholesterol concentration of hart patients and healthy subjects on average different?</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>chol <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;https://raw.githubusercontent.com/GTPB/PSLS20/master/data/chol.txt&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>chol<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(chol<span class="sc">$</span>group)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>nGroups <span class="ot">&lt;-</span> <span class="fu">table</span>(chol<span class="sc">$</span>group)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(nGroups)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>chol</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["fct"],"align":["left"]},{"label":["cholest"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"244"},{"1":"1","2":"206"},{"1":"1","2":"242"},{"1":"1","2":"278"},{"1":"1","2":"236"},{"1":"2","2":"188"},{"1":"2","2":"212"},{"1":"2","2":"186"},{"1":"2","2":"198"},{"1":"2","2":"160"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<hr />
<p><img src="02-ranktests_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /><img src="02-ranktests_files/figure-html/unnamed-chunk-2-2.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li>Possibly outliers</li>
<li>Difficult to assess distributional assumptions when only 5 observations are available.</li>
</ul>
</div>
<div id="permutation-tests" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Permutation tests</h2>
<p>If the data are not normally distributed or if we do not want to make distributional assumptions we can resort to a permutation test.</p>
<p><span class="math display">\[
H_0: f_1(x)=f_2(x)
\]</span></p>
<ul>
<li><p>Problem if we can reject the null hypothesis that their is an effect of the treatment, how can we interpret how the difference between both distributions?</p></li>
<li><p>In order enable an useful interpretation if we use an permutation t-test, we have to make additional assumptions:</p></li>
<li><p>location shift model: we assume that the distributions have the same shape but that the treatment can only induce a shift in the location of the distribution:</p></li>
</ul>
<p><span class="math display">\[ 
H_0: f_1(x)=f_2(x) \text{ vs } H_1: \{\forall y: f_1(y)=f_2(y-\Delta)\}
\]</span> with <span class="math display">\[
\Delta = \mu_1 - \mu_2
\]</span></p>
<ul>
<li><p>Under this assumption we can again interpret a rejection of <span class="math inline">\(H_0\)</span> in terms of a difference in means.</p></li>
<li><p>However, we would have to assess this assumption.</p></li>
<li><p>Instead we will resort to rank tests, which will allow to further relax this assumption!</p></li>
</ul>
</div>
<div id="rank-tests" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Rank Tests</h2>
<ul>
<li>Important group of non-parametric test
<ul>
<li>Non-parametric,</li>
<li>Exact <span class="math inline">\(p\)</span>-values using a permutation null distribution.</li>
<li>No need for separate permutation distribution for each new dataset.</li>
<li>Permutation null distribution of rank tests only depends on sample size</li>
<li>Robust to outliers</li>
</ul></li>
</ul>
<hr />
</div>
</div>
<div id="ranks" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Ranks</h1>
<p>Rank tests start from rank-transformed data.</p>
<ul>
<li>Let <span class="math inline">\(Y_1, \ldots, Y_n\)</span>.</li>
<li>In the absence of <em>ties</em> <span class="math display">\[R_i=R(Y_i) = \#\{Y_j: Y_j\leq Y_i; j=1,\ldots, n\}\]</span></li>
<li>Smallest observation has rank 1, second smallest rank 2, … , largest observation gets rank <span class="math inline">\(n\)</span></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>chol <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(cholest)</span></code></pre></div>
<pre><code> [1] 244 206 242 278 236 188 212 186 198 160</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>chol <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(cholest) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    rank</span></code></pre></div>
<pre><code> [1]  9  5  8 10  7  3  6  2  4  1</code></pre>
<hr />
<div id="ties" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Ties</h2>
<p>Sometimes <em>ties</em> occur: two observations with identical values</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>withTies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">403</span>, <span class="dv">507</span>, <span class="dv">507</span>, <span class="dv">610</span>, <span class="dv">651</span>, <span class="dv">651</span>, <span class="dv">651</span>, <span class="dv">830</span>, <span class="dv">900</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rank</span>(withTies)</span></code></pre></div>
<pre><code>[1] 1.0 2.5 2.5 4.0 6.0 6.0 6.0 8.0 9.0</code></pre>
<ul>
<li><p>Ties: 507 occurs twice, 651 occurs 3 times</p></li>
<li><p>If ties occur <em>midranks</em> are used.</p></li>
<li><p><strong>midrank</strong> of observation <span class="math inline">\(Y_i\)</span> becomes <span class="math display">\[\begin{eqnarray*}
 R_i &amp;=&amp; \frac{ \#\{Y_j: Y_j\leq Y_i\} + ( \#\{Y_j: Y_j &lt; Y_i\} +1)}{2}.
 \end{eqnarray*}\]</span></p></li>
</ul>
<hr />
</div>
<div id="ranks-of-pooled-sample" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Ranks of pooled sample</h2>
<ul>
<li>Let <span class="math inline">\(Y_{ij}\)</span>, <span class="math inline">\(i=1,\ldots, n_j\)</span> be observations from two treatment groups <span class="math inline">\(j=1,2\)</span>.</li>
<li>They can also be represented by <span class="math inline">\(Z_1,\ldots, Z_n\)</span> (<span class="math inline">\(n=n_1+n_2\)</span>), the outcomes of the pooled sample</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>chol <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ranks =</span> <span class="fu">rank</span>(cholest))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["fct"],"align":["left"]},{"label":["cholest"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["ranks"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"244","3":"9"},{"1":"1","2":"206","3":"5"},{"1":"1","2":"242","3":"8"},{"1":"1","2":"278","3":"10"},{"1":"1","2":"236","3":"7"},{"1":"2","2":"188","3":"3"},{"1":"2","2":"212","3":"6"},{"1":"2","2":"186","3":"2"},{"1":"2","2":"198","3":"4"},{"1":"2","2":"160","3":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<hr />
</div>
</div>
<div id="wilcoxon-mann-whitney-test" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Wilcoxon-Mann-Whitney Test</h1>
<p>Simultaneously developed by Wilcoxon, and, Mann and Whitney: <strong>Wilcoxon-Mann-Whitney</strong>, <strong>Wilcoxon rank sum test</strong> or <strong>Mann-Whitney U test</strong></p>
<div id="hypotheses" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Hypotheses</h2>
<p>Under <span class="math inline">\(H_0\)</span> the distributions of the two groups are equal <span class="math display">\[H_0: f_1=f_2\]</span></p>
<p>Under the alternative <span class="math inline">\(H_1\)</span> the distributions differ in location <span class="math display">\[H_1: \mu_1\neq \mu_2\]</span></p>
<p><span class="math inline">\(H_1\)</span> assumes <strong>location-shift</strong>, we will relax this assumption later on.</p>
</div>
<div id="test-statistic" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Test statistic</h2>
<p>Classic T-test: assesses the difference in sample means <span class="math inline">\(\bar{Y}_1-\bar{Y}_2\)</span>.</p>
<p>Here: Difference in sample means based on rank transformed data</p>
<p>Ranks based on the pooled sample (upon joining the observations from the two groups): <span class="math inline">\(R_{ij}=R(Y_{ij})\)</span> is de rank of observation <span class="math inline">\(Y_{ij}\)</span> in the pooled sample.</p>
<p><span class="math display">\[
  T = \frac{1}{n_1}\sum_{i=1}^{n_1} R(Y_{i1}) - \frac{1}{n_2}\sum_{i=1}^{n_2} R(Y_{i2}) .
\]</span></p>
<ul>
<li><p>Under <span class="math inline">\(H_0\)</span> we expect the average rank of the first group to be close to that of the second group so <span class="math inline">\(T\)</span> is close to zero.</p></li>
<li><p>Under <span class="math inline">\(H_1\)</span> we expect the mean ranks to differ so that <span class="math inline">\(T\)</span> deviates from zero.</p></li>
<li><p>It is sufficient to only calculate <span class="math display">\[S_1=\sum_{i=1}^{n_1} R(Y_{i1})\]</span>.</p></li>
<li><p><span class="math inline">\(S_1\)</span> is the sum of the ranks of the first group: <em>rank sum test</em>.</p></li>
<li><p>This holds because <span class="math display">\[
S_1+S_2 = \text{sum of all ranks} = 1+2+\cdots + n=\frac{1}{2}n(n+1).
\]</span></p></li>
<li><p><span class="math inline">\(S_1\)</span> (or <span class="math inline">\(S_2\)</span>) is a good test statistic</p></li>
<li><p>Use permutations to determine the exact permutation distribution. (Permute the ranks between the groups)</p></li>
<li><p>For a given <span class="math inline">\(n\)</span> and no <em>ties</em> the rank transformed data is always <span class="math display">\[1, 2, \ldots, n\]</span></p></li>
<li><p>For given <span class="math inline">\(n_1\)</span> en <span class="math inline">\(n_2\)</span> the permutation distribution is always the same!</p></li>
<li><p>With current computing power this is not so important any more.</p></li>
</ul>
<hr />
</div>
<div id="standardized-statistic" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Standardized statistic</h2>
<p>Often the standardized test statistic is used <span class="math display">\[
  T = \frac{S_1-\text{E}_{0}\left[S_1\right]}{\sqrt{\text{Var}_{0}\left[S_1\right]}},
\]</span></p>
<ul>
<li><p>with <span class="math inline">\(\text{E}_{0}\left[S_1\right]\)</span> and <span class="math inline">\(\text{Var}_{0}\left[S_1\right]\)</span> the expect mean and variance of S1 under <span class="math inline">\(H_0\)</span>.</p></li>
<li><p>Under <span class="math inline">\(H_0\)</span> <span class="math display">\[
 \text{E}_{0}\left[S_1\right]= \frac{1}{2}n_1(n+1) \;\;\;\;\text{ en }\;\;\;\; \text{Var}_{0}\left[S_1\right]=\frac{1}{12}n_1n_2(n+1).
 \]</span></p></li>
<li><p>Under <span class="math inline">\(H_0\)</span> and when <span class="math inline">\(\min(n_1,n_2)\rightarrow \infty\)</span> <span class="math display">\[
  T = \frac{S_1-\text{E}_{0}\left[S_1\right]}{\sqrt{\text{Var}_{0}\left[S_1\right]}} \rightarrow N(0,1).
 \]</span></p></li>
</ul>
<p>Asymptotically the standardised statistic follows a standard normal distribution!</p>
<hr />
</div>
<div id="cholesterol-example-1" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Cholesterol example</h2>
<p>We illustrate the result for the cholesterol example using the R function <code>wilcox.test</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(cholest <span class="sc">~</span> group, <span class="at">data =</span> chol)</span></code></pre></div>
<pre><code>
    Wilcoxon rank sum exact test

data:  cholest by group
W = 24, p-value = 0.01587
alternative hypothesis: true location shift is not equal to 0</code></pre>
<ul>
<li><p>We reject <span class="math inline">\(H_0\)</span> (<span class="math inline">\(p=\)</span> 0.016 <span class="math inline">\(&lt;0.05\)</span>)</p></li>
<li><p>The output shows <span class="math inline">\(W=\)</span> 24?</p></li>
<li><p>Lets calculate</p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>S1 <span class="ot">&lt;-</span> chol <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ranks =</span> <span class="fu">rank</span>(cholest)) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(group <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(ranks) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    sum </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>S1</span></code></pre></div>
<pre><code>[1] 39</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>S2 <span class="ot">&lt;-</span> chol <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ranks =</span> <span class="fu">rank</span>(cholest)) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(group <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(ranks) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    sum </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>S2</span></code></pre></div>
<pre><code>[1] 16</code></pre>
<ul>
<li>Where does <span class="math inline">\(W=\)</span> 24 comes from?</li>
</ul>
<hr />
</div>
<div id="mann-and-whitney-test" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Mann and Whitney test</h2>
<p>Mann and Whitney test in absence of ties: <span class="math display">\[
 U_1 = \sum_{i=1}^{n_1}\sum_{k=1}^{n_2} \text{I}\left\{Y_{i1}\geq Y_{k2}\right\}.
\]</span></p>
<ul>
<li><p>with <span class="math inline">\(\text{I}\left\{.\right\}\)</span> an indicator that equals 1 if the expression is true and is zero otherwise.</p></li>
<li><p>U counts how many times an observation of the first group is larger or equal to an observation from the second group.</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> chol <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(group <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(cholest)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> chol <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(group <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(cholest)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>u1Hlp <span class="ot">&lt;-</span> <span class="fu">sapply</span>(y1, <span class="cf">function</span>(y1i, y2) {</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  y1i <span class="sc">&gt;=</span> y2</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>}, <span class="at">y2 =</span> y2)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(u1Hlp) <span class="ot">&lt;-</span> y1</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(u1Hlp) <span class="ot">&lt;-</span> y2</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>u1Hlp</span></code></pre></div>
<pre><code>     244   206  242  278  236
188 TRUE  TRUE TRUE TRUE TRUE
212 TRUE FALSE TRUE TRUE TRUE
186 TRUE  TRUE TRUE TRUE TRUE
198 TRUE  TRUE TRUE TRUE TRUE
160 TRUE  TRUE TRUE TRUE TRUE</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>U1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(u1Hlp)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>U1</span></code></pre></div>
<pre><code>[1] 24</code></pre>
<p>It can be shown that <span class="math inline">\(U_1 = S_1 - \frac{1}{2}n_1(n_1+1).\)</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>S1 <span class="sc">-</span> nGroups[<span class="dv">1</span>] <span class="sc">*</span> (nGroups[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span></code></pre></div>
<pre><code> 1 
24 </code></pre>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(U_1\)</span> en <span class="math inline">\(S_1\)</span> contain the same information</li>
<li><span class="math inline">\(U_1\)</span> is also a rank statistic, and</li>
<li>Exact test based on <span class="math inline">\(U_1\)</span> and <span class="math inline">\(S_1\)</span> are equivalent.</li>
</ol>
<hr />
</div>
<div id="probabilistic-index" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Probabilistic index</h2>
<ul>
<li><span class="math inline">\(U_1\)</span> has a better interpretation feature</li>
<li>Let <span class="math inline">\(Y_j\)</span> a random observation from group <span class="math inline">\(j\)</span> (<span class="math inline">\(j=1,2\)</span>). Then <span class="math display">\[\begin{eqnarray*}
\frac{1}{n_1n_2}\text{E}\left[U_1\right]
   &amp;=&amp; \text{P}\left[Y_1 \geq Y_2\right].
\end{eqnarray*}\]</span></li>
</ul>
<p>So we can estimate the probability by calculating the mean of all indicator variable values <span class="math inline">\(\text{I}\left\{Y_{i1}\geq Y_{k2}\right\}\)</span>. Note, that we did <span class="math inline">\(n_1 \times n_2\)</span> comparisons</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(u1Hlp)</span></code></pre></div>
<pre><code>[1] 0.96</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>U1 <span class="sc">/</span> (nGroups[<span class="dv">1</span>] <span class="sc">*</span> nGroups[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>   1 
0.96 </code></pre>
<ul>
<li><p>Probability <span class="math inline">\(\text{P}\left[Y_1 \geq Y_2\right]\)</span> is referred to as the <em>probabilistic index</em>.</p></li>
<li><p>It is the probability that a random observation of the first group is larger or equal than a random observation of the second group</p></li>
<li><p>If <span class="math inline">\(H_0\)</span> holds <span class="math inline">\(\text{P}\left[Y_1 \geq Y_2\right]=\frac{1}{2}\)</span>.</p></li>
<li><p>R function <code>wilcox.test</code> does not return the Wilcoxon rank sum statistic. It returns the Mann-Whitney statistic <span class="math inline">\(U_1\)</span>.</p></li>
<li><p>Lets revisit the result</p></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>wTest <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(cholest <span class="sc">~</span> group, <span class="at">data =</span> chol)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>wTest</span></code></pre></div>
<pre><code>
    Wilcoxon rank sum exact test

data:  cholest by group
W = 24, p-value = 0.01587
alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>U1</span></code></pre></div>
<pre><code>[1] 24</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>probInd <span class="ot">&lt;-</span> wTest<span class="sc">$</span>statistic <span class="sc">/</span> <span class="fu">prod</span>(nGroups)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>probInd</span></code></pre></div>
<pre><code>   W 
0.96 </code></pre>
<p>Because <span class="math inline">\(p=\)</span> 0.0159 <span class="math inline">\(&lt;0.05\)</span> we conclude at the <span class="math inline">\(5\%\)</span> significance level that the mean cholesterol level of hart patients is larger then that of healthy subjects.</p>
<ul>
<li>Note that we have assumed that the location-shift model is valid in this conclusion.</li>
<li>We also know that higher cholesterol level are more likely for hart patients then for healthy subjects and this probability is <span class="math inline">\(U1/(n_1\times n_2)=\)</span> 96%.</li>
<li>We should assess the location shift assumption. But this is not possible with only 5 observations.</li>
</ul>
<p>Without the location-shift assumption the conclusion in terms of the probabilistic index remains valid!</p>
<ul>
<li>So when we do not assume location shift we test for</li>
</ul>
<p><span class="math display">\[H_0: F_1=F_2 \text{ vs } H_1: P[Y_1 \geq Y_2] \neq 0.5.\]</span></p>
</div>
<div id="conclusion" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Conclusion</h2>
<p>There is a significant difference in the distribution of the cholesterol concentration of hart patients two days upon a stroke and that of healthy subject (<span class="math inline">\(p=\)</span> 0.0159). It is more likely to observe higher cholesterol levels for hart patients then for healthy subjects. The point estimator for this probability is 96%.</p>
</div>
</div>
<div id="comparison-of-g-groups" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Comparison of <span class="math inline">\(g\)</span> groups</h1>
<ul>
<li>Extend <span class="math inline">\(F\)</span>-test from a one-way ANOVA to non-parametric alternatives.</li>
</ul>
</div>
<div id="dmh-example" class="section level1" number="5">
<h1><span class="header-section-number">5</span> DMH example</h1>
<p>Assess genotoxicity of 1,2-dimethylhydrazine dihydrochloride (DMH) (EU directive)</p>
<ul>
<li>24 rats</li>
<li>four groups with daily DMH dose
<ul>
<li>control</li>
<li>low</li>
<li>medium</li>
<li>high</li>
</ul></li>
<li>Genotoxicity in liver using comet assay on 150 liver cells per rat.</li>
<li>Are there differences in DNA damage due to DMH dose?</li>
</ul>
<div id="comet-assay" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Comet Assay:</h2>
<ul>
<li>Visualise DNA strand breaks</li>
<li>Length comet tail is a proxy for strand breaks.</li>
</ul>
<div class="figure">
<img src="https://raw.githubusercontent.com/GTPB/PSLS20/gh-pages/assets/figs/comet.jpg" style="width:50.0%" alt="" />
<p class="caption">Comet assay</p>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dna <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;https://raw.githubusercontent.com/GTPB/PSLS20/master/data/dna.txt&quot;</span>, <span class="at">delim =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>dna<span class="sc">$</span>dose <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dna<span class="sc">$</span>dose)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>dna</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["length"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dose"],"name":[3],"type":["fct"],"align":["left"]}],"data":[{"1":"Rat1","2":"19.33632","3":"0"},{"1":"Rat2","2":"18.92102","3":"0"},{"1":"Rat3","2":"18.56595","3":"0"},{"1":"Rat4","2":"18.96406","3":"0"},{"1":"Rat5","2":"17.07120","3":"0"},{"1":"Rat6","2":"18.82054","3":"0"},{"1":"Rat7","2":"55.39238","3":"1.25"},{"1":"Rat8","2":"59.18181","3":"1.25"},{"1":"Rat9","2":"59.12988","3":"1.25"},{"1":"Rat10","2":"52.11263","3":"1.25"},{"1":"Rat11","2":"51.69292","3":"1.25"},{"1":"Rat12","2":"51.26484","3":"1.25"},{"1":"Rat13","2":"60.19983","3":"2.5"},{"1":"Rat14","2":"59.74679","3":"2.5"},{"1":"Rat15","2":"56.83087","3":"2.5"},{"1":"Rat16","2":"50.45545","3":"2.5"},{"1":"Rat17","2":"57.27770","3":"2.5"},{"1":"Rat18","2":"51.23312","3":"2.5"},{"1":"Rat19","2":"62.61736","3":"5"},{"1":"Rat20","2":"60.36182","3":"5"},{"1":"Rat21","2":"64.60083","3":"5"},{"1":"Rat22","2":"51.44252","3":"5"},{"1":"Rat23","2":"54.35088","3":"5"},{"1":"Rat24","2":"55.86383","3":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>dna <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dose, <span class="at">y =</span> length, <span class="at">fill =</span> dose)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>)</span></code></pre></div>
<p><img src="02-ranktests_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>dna <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> length)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>dose)</span></code></pre></div>
<p><img src="02-ranktests_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
<ul>
<li>Strong indication that data in control group has a lower variance.</li>
<li>6 observations per group are too few to check the assumptions</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">lm</span>(length <span class="sc">~</span> dose, <span class="at">data =</span> dna))</span></code></pre></div>
<p><img src="02-ranktests_files/figure-html/unnamed-chunk-15-1.png" width="672" /><img src="02-ranktests_files/figure-html/unnamed-chunk-15-2.png" width="672" /><img src="02-ranktests_files/figure-html/unnamed-chunk-15-3.png" width="672" /><img src="02-ranktests_files/figure-html/unnamed-chunk-15-4.png" width="672" /></p>
</div>
</div>
<div id="kruskal-wallis-rank-test" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Kruskal-Wallis Rank Test</h1>
<ul>
<li><p>The Kruskal-Wallis Rank Test (KW-test) is a non-parameteric alternative for ANOVA F-test.</p></li>
<li><p>Classical <span class="math inline">\(F\)</span>-teststatistic can be written as <span class="math display">\[
 F = \frac{\text{SST}/(g-1)}{\text{SSE}/(n-g)} = \frac{\text{SST}/(g-1)}{(\text{SSTot}-\text{SST})/(n-g)} ,
  \]</span></p></li>
<li><p>with <span class="math inline">\(g\)</span> the number of groups.</p></li>
<li><p>SSTot depends only on outcomes <span class="math inline">\(\mathbf{y}\)</span> and will not vary in permutation test.</p></li>
<li><p>SST can be used as statistic <span class="math display">\[\text{SST}=\sum_{j=1}^t n_j(\bar{Y}_j-\bar{Y})^2\]</span></p></li>
<li><p>The KW test statistic is based on SST on rank-transformed outcomes<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, <span class="math display">\[
  \text{SST} = \sum_{j=1}^g n_j \left(\bar{R}_j - \bar{R}\right)^2 = \sum_{j=1}^t n_j \left(\bar{R}_j - \frac{n+1}{2}\right)^2 ,
  \]</span></p></li>
<li><p>with <span class="math inline">\(\bar{R}_j\)</span> the mean of the ranks in group <span class="math inline">\(j\)</span>, and <span class="math inline">\(\bar{R}\)</span> the mean of all ranks, <span class="math display">\[
 \bar{R} = \frac{1}{n}(1+2+\cdots + n) = \frac{1}{n}\frac{1}{2}n(n+1) = \frac{n+1}{2}.
  \]</span></p></li>
<li><p>The KW teststatistic is given by <span class="math display">\[
 KW = \frac{12}{n(n+1)}  \sum_{j=1}^g n_j \left(\bar{R}_j - \frac{n+1}{2}\right)^2.
  \]</span></p></li>
<li><p>The factor <span class="math inline">\(\frac{12}{n(n+1)}\)</span> is used so that <span class="math inline">\(KW\)</span> has a simple asymptotic null distribution. In particular under <span class="math inline">\(H_0\)</span>, given thart <span class="math inline">\(\min(n_1,\ldots, n_g)\rightarrow \infty\)</span>, <span class="math display">\[
 KW  \rightarrow \chi^2_{t-1}.
  \]</span></p></li>
<li><p>The exact KW-test can be executed by calculating the permutation null distribution (that only depends on <span class="math inline">\(n_1, \ldots, n_g\)</span>) to test <span class="math display">\[H_0: f_1=\ldots=f_g \text{ vs } H_1: \text{ at least two means are different}.\]</span></p></li>
<li><p>In order to allow <span class="math inline">\(H_1\)</span> to be formulated in terms of means, the assumption of locations shift should be valid.</p></li>
<li><p>For DMH example this is not the case.</p></li>
<li><p>If location-shift is invalid, we have to formulate <span class="math inline">\(H_1\)</span> in terms of probabilistic indices: <span class="math display">\[H_0: f_1=\ldots=f_g \text{ vs } H_1: \exists\ j,k \in \{1,\ldots,g\} : \text{P}\left[Y_j\geq Y_k\right]\neq 0.5\]</span></p></li>
</ul>
<div id="dna-damage-example" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> DNA Damage Example</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(length <span class="sc">~</span> dose, <span class="at">data =</span> dna)</span></code></pre></div>
<pre><code>
    Kruskal-Wallis rank sum test

data:  length by dose
Kruskal-Wallis chi-squared = 14, df = 3, p-value = 0.002905</code></pre>
<ul>
<li><p>On the <span class="math inline">\(5\%\)</span> level of significance we can reject the null hypothesis.</p></li>
<li><p>R-functie <code>kruskal.test</code> only returns the asymptotic approximation for <span class="math inline">\(p\)</span>-values.</p></li>
<li><p>With only 6 observaties per groep, this is not a good approximation of the <span class="math inline">\(p\)</span>-value</p></li>
<li><p>With the <code>coin</code> R package we can calculate the exacte <span class="math inline">\(p\)</span>-value</p></li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coin)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>kwPerm <span class="ot">&lt;-</span> <span class="fu">kruskal_test</span>(length <span class="sc">~</span> dose,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dna,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">distribution =</span> <span class="fu">approximate</span>(<span class="at">B =</span> <span class="dv">100000</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>kwPerm</span></code></pre></div>
<pre><code>
    Approximative Kruskal-Wallis Test

data:  length by dose (0, 1.25, 2.5, 5)
chi-squared = 14, p-value = 0.00041</code></pre>
<ul>
<li><p>We conclude that the difference in the distribution of the DNA damages due to the DMH dose is extremely significantly different.</p></li>
<li><p>Posthoc analysis with WMW tests.</p></li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(dna<span class="sc">$</span>length, dna<span class="sc">$</span>dose)</span></code></pre></div>
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum exact test 

data:  dna$length and dna$dose 

     0     1.25  2.5  
1.25 0.013 -     -    
2.5  0.013 0.818 -    
5    0.013 0.721 0.788

P value adjustment method: holm </code></pre>
<ul>
<li>All DMH behandelingen are significantly different from the control.</li>
<li>The DMH are not significantly different from one another.</li>
<li>U1 does not occur in the <code>pairwise.wilcox.test</code> output. Point estimate on probability on higher DNA-damage?</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>nGroup <span class="ot">&lt;-</span> <span class="fu">table</span>(dna<span class="sc">$</span>dose)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>probInd <span class="ot">&lt;-</span> <span class="fu">combn</span>(<span class="fu">levels</span>(dna<span class="sc">$</span>dose), <span class="dv">2</span>, <span class="cf">function</span>(x) {</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(length <span class="sc">~</span> dose, <span class="fu">subset</span>(dna, dose <span class="sc">%in%</span> x))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(test<span class="sc">$</span>statistic <span class="sc">/</span> <span class="fu">prod</span>(nGroup[x]))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(probInd) <span class="ot">&lt;-</span> <span class="fu">combn</span>(<span class="fu">levels</span>(dna<span class="sc">$</span>dose), <span class="dv">2</span>, paste, <span class="at">collapse =</span> <span class="st">&quot;vs&quot;</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>probInd</span></code></pre></div>
<pre><code>  0vs1.25    0vs2.5      0vs5 1.25vs2.5   1.25vs5    2.5vs5 
0.0000000 0.0000000 0.0000000 0.4444444 0.2777778 0.3333333 </code></pre>
<p>Because there are doubts on the location-shift model we draw our conclusions in terms of the probabilistic index.</p>
<div id="conclusion-1" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Conclusion</h3>
<ul>
<li>There is an extremely significant difference in in the distribution of the DNA-damage measurements due to the treatment with DMH (<span class="math inline">\(p&lt;0.001\)</span> KW-test).</li>
<li>DNA-damage is more likely upon DMH treatment than in the control treatment (all p=0.013, WMW-testen).</li>
<li>The probability on higher DNA-damage upon exposure to DMH is 100% (Calculation of a CI on the probabilistic index is beyond the scope of the course)</li>
<li>There are no significant differences in the distributions of the comit-lengths among the treatment with the different DMH concentrations (<span class="math inline">\(p=\)</span> 0.72-0.82).</li>
<li>DMH shows already genotoxic effects at low dose.</li>
<li>(All pairwise tests are corrected for multiple testing using Holm’s method).</li>
</ul>
</div>
</div>
</div>
<div id="probabilistic-index-models-pim" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Probabilistic index models (PIM)</h1>
<ul>
<li><p>In the last decade we developed PIM models at Ghent University</p></li>
<li><p>PIM generalises the Wilcoxon-Mann_Withney and Kruskal Wallis tests towards a regression framework for the probabilistic index.</p></li>
<li><p>PIM provides a nonparametric regression framework for experiments with simple and complex experimental designs.</p></li>
<li><p>Thas, O., Deneve, J., Clement, L. &amp; Ottoy, J.P. (2012). Probabilistic Index Models. Journal of the Royal Society Series B (Statistical Methodology), 74(4): 623-671. DOI: 10.1111/j.1467-9868.2011.01020.x</p></li>
<li><p>De Neve, J. &amp; Thas, O. (2015). A Regression Framework for Rank Tests Based on the Probabilistic Index Model, Journal of the American Statistical Association, 110:511, 1276-1283, DOI: 10.1080/01621459.2015.1016226</p></li>
<li><p>Amorim G. et al. (2018). Small sample inference for probabilistic index models. Computational Statistics &amp; Data Analysis, 121:137-148. DOI: 10.1016/j.csda.2017.11.005</p></li>
<li><p>De Schrijver, M. and De Neve, J. (2019) A tutorial on probabilistic index models: Regression models for the effect size P(Y1 &lt; Y2). Psychological Methods, 24(4), 403–418. DOI: 10.1037/met0000194</p></li>
<li><p>…</p></li>
</ul>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>we assume that no <em>ties</em> are available<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiMi4gUmFuayBUZXN0cyIKYXV0aG9yOiAiTGlldmVuIENsZW1lbnQiCmRhdGU6ICJzdGF0T21pY3MsIEdoZW50IFVuaXZlcnNpdHkgKGh0dHBzOi8vc3RhdG9taWNzLmdpdGh1Yi5pbykiCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGU9RkFMU0UsIGNhY2hlPUZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQoCiAgaW5jbHVkZSA9IFRSVUUsIGNvbW1lbnQgPSBOQSwgZWNobyA9IFRSVUUsCiAgbWVzc2FnZSA9IEZBTFNFLCB3YXJuaW5nID0gRkFMU0UsIGNhY2hlID0gVFJVRQopCmxpYnJhcnkodGlkeXZlcnNlKQpgYGAKCgojIEludHJvZHVjdGlvbgoKSW5mZXJlbmNlIHdhcyBvbmx5IGNvcnJlY3QgaWYgZGlzdHJpYnV0aW9uYWwgYXNzdW1wdGlvbnMgd2VyZSBzYXRpc2ZpZWQKCi0gZS5nIE5vcm1hbCBkaXN0cmlidXRpb24KLSBlcXVhbCB2YXJpYW5jZQoKLSAgVGhlICRwJC12YWx1ZTogJFx0ZXh0e1B9XzBcbGVmdFsgXHZlcnQgVFx2ZXJ0IFxnZXEgXHZlcnQgdCBcdmVydCBccmlnaHRdJC4KCgktIENhbGN1bGF0ZWQgdXNpbmcgdGhlIG51bGwgZGlzdHJpYnV0aW9uIG9mICRUJCB0aGF0IHdlIGRlcml2ZWQgdW5kZXIgdGhlIGFzc3VtcHRpb25zCgktIEluIGNvcnJlY3QgaWYgYXNzdW1wdGlvbnMgYXJlIHZpb2xhdGVkCgotICAkOTVcJSQgQ0kgYWxzbyBidWlsZHMgdXBvbiB0aGVzZSBhc3N1bXB0aW9ucy4gSWYgdGhleSBhcmUgaW52YWxpZCB0aGVuIHRoZSBpbnRlcnZhbHMgd2lsbCBub3QgY29udGFpbiB0aGUgcG9wdWxhdGlvbiBwYXJhbWV0ZXIgd2l0aCA5NSUgcHJvYmFiaWxpdHkuCgotIEFzeW1wdG90aWMgdGhlb3J5IGlzIG1vcmUgZGlmZmljdWx0IHRvIHBsYWNlOiB0aGUgJHQkLXRlc3QgaXMgYXN5bXB0b3RpY2FsbHkgbm9uLXBhcmFtZXRyaWMgYmVjYXVzZSBmb3IgdmVyeSBsYXJnZSBzYW1wbGVzIHRoZSBkaXN0cmlidXRpb25hbCBhc3N1bXB0aW9ucyBvZiBub3JtYWxpdHkgYXJlIG5vIGxvbmdlciBpbXBvcnRhbnQuCgotIElmIGFzc3VtcHRpb25zIGhvbGQgdGhlIHBhcmFtZXRyaWMgYXBwcm9hY2gKCgktIG1vcmUgZWZmaWNpZW50OiBsYXJnZXIgcG93ZXIgd2l0aCBzYW1lIHNhbXBsZSBzaXplICsgc21hbGxlciBDSS4KCS0gbW9yZSBmbGV4aWJsZTogZWFzaWVyIHRvIGFuYWx5c2UgZGF0YSB3aXRoIGNvbXBsZXggZGVzaWducwoKLS0tCgojIyBDaG9sZXN0ZXJvbCBleGFtcGxlCgotIENob2xlc3Rlcm9sIGNvbmNlbnRyYXRpb24gaW4gYmxvb2QgbWVhc3VyZWQgZm9yCiAgLSA1IHBhdGllbnRzIChncm91cD0xKSB0d28gZGF5cyB1cG9uIGEgc3Ryb2tlCiAgLSA1IGhlYWx0aHkgc3ViamVjdCAoZ3JvZXA9MikuCgotIElzIGNob2xlc3Rlcm9sIGNvbmNlbnRyYXRpb24gb2YgaGFydCBwYXRpZW50cyBhbmQgaGVhbHRoeSBzdWJqZWN0cyBvbiBhdmVyYWdlIGRpZmZlcmVudD8KCmBgYHtyfQpjaG9sIDwtIHJlYWRfdHN2KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vR1RQQi9QU0xTMjAvbWFzdGVyL2RhdGEvY2hvbC50eHQiKQpjaG9sJGdyb3VwIDwtIGFzLmZhY3RvcihjaG9sJGdyb3VwKQpuR3JvdXBzIDwtIHRhYmxlKGNob2wkZ3JvdXApCm4gPC0gc3VtKG5Hcm91cHMpCmNob2wKYGBgCgotLS0KCgpgYGB7ciwgZWNobz1GQUxTRSwgZmlnLmFsaWduPSdjZW50ZXInfQpjaG9sICU+JSBnZ3Bsb3QoYWVzKHggPSBncm91cCwgeSA9IGNob2xlc3QpKSArCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSkgKwogIGdlb21fcG9pbnQocG9zaXRpb24gPSAiaml0dGVyIikKCmNob2wgJT4lIGdncGxvdChhZXMoc2FtcGxlID0gY2hvbGVzdCkpICsKICBnZW9tX3FxKCkgKwogIGdlb21fcXFfbGluZSgpICsKICBmYWNldF93cmFwKH5ncm91cCkKYGBgCgotIFBvc3NpYmx5IG91dGxpZXJzCi0gRGlmZmljdWx0IHRvIGFzc2VzcyBkaXN0cmlidXRpb25hbCBhc3N1bXB0aW9ucyB3aGVuIG9ubHkgNSBvYnNlcnZhdGlvbnMgYXJlIGF2YWlsYWJsZS4KCiMjIFBlcm11dGF0aW9uIHRlc3RzCgpJZiB0aGUgZGF0YSBhcmUgbm90IG5vcm1hbGx5IGRpc3RyaWJ1dGVkIG9yIGlmIHdlIGRvIG5vdCB3YW50IHRvIG1ha2UgZGlzdHJpYnV0aW9uYWwgYXNzdW1wdGlvbnMgd2UgY2FuIHJlc29ydCB0byBhIHBlcm11dGF0aW9uIHRlc3QuIAoKJCQKSF8wOiBmXzEoeCk9Zl8yKHgpCiQkCgotIFByb2JsZW0gaWYgd2UgY2FuIHJlamVjdCB0aGUgbnVsbCBoeXBvdGhlc2lzIHRoYXQgdGhlaXIgaXMgYW4gZWZmZWN0IG9mIHRoZSB0cmVhdG1lbnQsIGhvdyBjYW4gd2UgaW50ZXJwcmV0IGhvdyB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIGJvdGggZGlzdHJpYnV0aW9ucz8gCgotIEluIG9yZGVyIGVuYWJsZSBhbiB1c2VmdWwgaW50ZXJwcmV0YXRpb24gaWYgd2UgdXNlIGFuIHBlcm11dGF0aW9uIHQtdGVzdCwgd2UgaGF2ZSB0byBtYWtlIGFkZGl0aW9uYWwgYXNzdW1wdGlvbnM6IAoKLSBsb2NhdGlvbiBzaGlmdCBtb2RlbDogd2UgYXNzdW1lIHRoYXQgdGhlIGRpc3RyaWJ1dGlvbnMgaGF2ZSB0aGUgc2FtZSBzaGFwZSBidXQgdGhhdCB0aGUgdHJlYXRtZW50IGNhbiBvbmx5IGluZHVjZSBhIHNoaWZ0IGluIHRoZSBsb2NhdGlvbiBvZiB0aGUgZGlzdHJpYnV0aW9uOgoKJCQgCkhfMDogZl8xKHgpPWZfMih4KSBcdGV4dHsgdnMgfSBIXzE6IFx7XGZvcmFsbCB5OiBmXzEoeSk9Zl8yKHktXERlbHRhKVx9CiQkCndpdGggCiQkClxEZWx0YSA9IFxtdV8xIC0gXG11XzIKJCQKCi0gVW5kZXIgdGhpcyBhc3N1bXB0aW9uIHdlIGNhbiBhZ2FpbiBpbnRlcnByZXQgYSByZWplY3Rpb24gb2YgJEhfMCQgaW4gdGVybXMgb2YgYSBkaWZmZXJlbmNlIGluIG1lYW5zLiAKCi0gSG93ZXZlciwgd2Ugd291bGQgaGF2ZSB0byBhc3Nlc3MgdGhpcyBhc3N1bXB0aW9uLiAKCi0gSW5zdGVhZCB3ZSB3aWxsIHJlc29ydCB0byByYW5rIHRlc3RzLCB3aGljaCB3aWxsIGFsbG93IHRvIGZ1cnRoZXIgcmVsYXggdGhpcyBhc3N1bXB0aW9uISAKCiMjIFJhbmsgVGVzdHMKCi0gSW1wb3J0YW50IGdyb3VwIG9mIG5vbi1wYXJhbWV0cmljIHRlc3QKICAtIE5vbi1wYXJhbWV0cmljLAogIC0gRXhhY3QgJHAkLXZhbHVlcyB1c2luZyBhIHBlcm11dGF0aW9uIG51bGwgZGlzdHJpYnV0aW9uLgogIC0gTm8gbmVlZCBmb3Igc2VwYXJhdGUgcGVybXV0YXRpb24gZGlzdHJpYnV0aW9uIGZvciBlYWNoIG5ldyBkYXRhc2V0LgogIC0gUGVybXV0YXRpb24gbnVsbCBkaXN0cmlidXRpb24gb2YgcmFuayB0ZXN0cyBvbmx5IGRlcGVuZHMgb24gc2FtcGxlIHNpemUKICAtIFJvYnVzdCB0byBvdXRsaWVycwoKLS0tCgojIFJhbmtzCgpSYW5rIHRlc3RzIHN0YXJ0IGZyb20gcmFuay10cmFuc2Zvcm1lZCBkYXRhLgoKLSBMZXQgJFlfMSwgXGxkb3RzLCBZX24kLgotIEluIHRoZSBhYnNlbmNlIG9mICp0aWVzKgogICQkUl9pPVIoWV9pKSA9IFwjXHtZX2o6IFlfalxsZXEgWV9pOyBqPTEsXGxkb3RzLCBuXH0kJAotIFNtYWxsZXN0IG9ic2VydmF0aW9uIGhhcyByYW5rIDEsIHNlY29uZCBzbWFsbGVzdCByYW5rIDIsIC4uLiAsIGxhcmdlc3Qgb2JzZXJ2YXRpb24gZ2V0cyByYW5rICRuJAoKYGBge3J9CmNob2wgJT4lIAogICAgcHVsbChjaG9sZXN0KQpjaG9sICU+JSAKICAgIHB1bGwoY2hvbGVzdCkgJT4lIAogICAgcmFuawpgYGAKCi0tLQoKIyMgVGllcwoKU29tZXRpbWVzICp0aWVzKiBvY2N1cjogdHdvIG9ic2VydmF0aW9ucyB3aXRoIGlkZW50aWNhbCB2YWx1ZXMKCmBgYHtyfQp3aXRoVGllcyA8LSBjKDQwMywgNTA3LCA1MDcsIDYxMCwgNjUxLCA2NTEsIDY1MSwgODMwLCA5MDApCnJhbmsod2l0aFRpZXMpCmBgYAoKLSBUaWVzOiA1MDcgb2NjdXJzIHR3aWNlLCA2NTEgb2NjdXJzIDMgdGltZXMKLSBJZiB0aWVzIG9jY3VyICptaWRyYW5rcyogYXJlIHVzZWQuCgotICoqbWlkcmFuayoqIG9mIG9ic2VydmF0aW9uICRZX2kkIGJlY29tZXMKICBcYmVnaW57ZXFuYXJyYXkqfQogICBSX2kgJj0mIFxmcmFjeyBcI1x7WV9qOiBZX2pcbGVxIFlfaVx9ICsgKCBcI1x7WV9qOiBZX2ogPCBZX2lcfSArMSl9ezJ9LgogICBcZW5ke2VxbmFycmF5Kn0KCi0tLQoKIyMgUmFua3Mgb2YgcG9vbGVkIHNhbXBsZQoKLSBMZXQgJFlfe2lqfSQsICRpPTEsXGxkb3RzLCBuX2okIGJlIG9ic2VydmF0aW9ucyBmcm9tIHR3byB0cmVhdG1lbnQgZ3JvdXBzICRqPTEsMiQuCi0gVGhleSBjYW4gYWxzbyBiZSByZXByZXNlbnRlZCBieSAkWl8xLFxsZG90cywgWl9uJCAoJG49bl8xK25fMiQpLCB0aGUgb3V0Y29tZXMgb2YgdGhlIHBvb2xlZCBzYW1wbGUKCmBgYHtyfQpjaG9sICU+JSBtdXRhdGUocmFua3MgPSByYW5rKGNob2xlc3QpKQpgYGAKLS0tCgojIFdpbGNveG9uLU1hbm4tV2hpdG5leSBUZXN0CgogU2ltdWx0YW5lb3VzbHkgZGV2ZWxvcGVkIGJ5IFdpbGNveG9uLCBhbmQsICBNYW5uIGFuZCBXaGl0bmV5OiAgKipXaWxjb3hvbi1NYW5uLVdoaXRuZXkqKiwgKipXaWxjb3hvbiByYW5rIHN1bSB0ZXN0KiogIG9yICoqTWFubi1XaGl0bmV5IFUgdGVzdCoqCgojIyBIeXBvdGhlc2VzCgpVbmRlciAkSF8wJCB0aGUgZGlzdHJpYnV0aW9ucyBvZiB0aGUgdHdvIGdyb3VwcyBhcmUgZXF1YWwKJCRIXzA6IGZfMT1mXzIkJAoKClVuZGVyIHRoZSBhbHRlcm5hdGl2ZSAkSF8xJCB0aGUgZGlzdHJpYnV0aW9ucyBkaWZmZXIgaW4gbG9jYXRpb24gJCRIXzE6IFxtdV8xXG5lcSBcbXVfMiQkCgokSF8xJCBhc3N1bWVzICoqbG9jYXRpb24tc2hpZnQqKiwgd2Ugd2lsbCByZWxheCB0aGlzIGFzc3VtcHRpb24gbGF0ZXIgb24uCgojIyBUZXN0IHN0YXRpc3RpYwoKQ2xhc3NpYyBULXRlc3Q6IGFzc2Vzc2VzIHRoZSBkaWZmZXJlbmNlIGluIHNhbXBsZSBtZWFucyAkXGJhcntZfV8xLVxiYXJ7WX1fMiQuCgpIZXJlOiBEaWZmZXJlbmNlIGluIHNhbXBsZSBtZWFucyBiYXNlZCBvbiByYW5rIHRyYW5zZm9ybWVkIGRhdGEKClJhbmtzIGJhc2VkIG9uIHRoZSBwb29sZWQgc2FtcGxlICh1cG9uIGpvaW5pbmcgdGhlIG9ic2VydmF0aW9ucyBmcm9tIHRoZSB0d28gZ3JvdXBzKTogJFJfe2lqfT1SKFlfe2lqfSkkIGlzIGRlIHJhbmsgb2Ygb2JzZXJ2YXRpb24gJFlfe2lqfSQgaW4gdGhlIHBvb2xlZCBzYW1wbGUuCgpcWwogIFQgPSBcZnJhY3sxfXtuXzF9XHN1bV97aT0xfV57bl8xfSBSKFlfe2kxfSkgLSBcZnJhY3sxfXtuXzJ9XHN1bV97aT0xfV57bl8yfSBSKFlfe2kyfSkgLgpcXQoKLSBVbmRlciAkSF8wJCB3ZSBleHBlY3QgdGhlIGF2ZXJhZ2UgcmFuayBvZiB0aGUgZmlyc3QgZ3JvdXAgdG8gYmUgY2xvc2UgdG8gdGhhdCBvZiB0aGUgc2Vjb25kIGdyb3VwIHNvICRUJCBpcyBjbG9zZSB0byB6ZXJvLgoKLSBVbmRlciAkSF8xJCB3ZSBleHBlY3QgdGhlIG1lYW4gcmFua3MgdG8gZGlmZmVyIHNvIHRoYXQgJFQkIGRldmlhdGVzIGZyb20gemVyby4KCi0gSXQgaXMgc3VmZmljaWVudCB0byBvbmx5IGNhbGN1bGF0ZQogICQkU18xPVxzdW1fe2k9MX1ee25fMX0gUihZX3tpMX0pJCQuCgotICRTXzEkIGlzIHRoZSBzdW0gb2YgdGhlIHJhbmtzIG9mIHRoZSBmaXJzdCBncm91cDogKnJhbmsgc3VtIHRlc3QqLgoKLSBUaGlzIGhvbGRzIGJlY2F1c2UKXFsKICBTXzErU18yID0gXHRleHR7c3VtIG9mIGFsbCByYW5rc30gPSAxKzIrXGNkb3RzICsgbj1cZnJhY3sxfXsyfW4obisxKS4KXF0KCgotICRTXzEkIChvciAkU18yJCkgaXMgYSBnb29kIHRlc3Qgc3RhdGlzdGljCgotIFVzZSBwZXJtdXRhdGlvbnMgdG8gZGV0ZXJtaW5lIHRoZSBleGFjdCBwZXJtdXRhdGlvbiBkaXN0cmlidXRpb24uIChQZXJtdXRlIHRoZSByYW5rcyBiZXR3ZWVuIHRoZSBncm91cHMpCgotIEZvciBhIGdpdmVuICRuJCBhbmQgbm8gKnRpZXMqIHRoZSByYW5rIHRyYW5zZm9ybWVkIGRhdGEgaXMgYWx3YXlzCiAgJCQxLCAyLCBcbGRvdHMsIG4kJAotIEZvciBnaXZlbiAkbl8xJCBlbiAkbl8yJCB0aGUgcGVybXV0YXRpb24gZGlzdHJpYnV0aW9uIGlzIGFsd2F5cyB0aGUgc2FtZSEKLSBXaXRoIGN1cnJlbnQgY29tcHV0aW5nIHBvd2VyIHRoaXMgaXMgbm90IHNvIGltcG9ydGFudCBhbnkgbW9yZS4KCi0tLQoKIyMgU3RhbmRhcmRpemVkIHN0YXRpc3RpYwoKT2Z0ZW4gdGhlIHN0YW5kYXJkaXplZCB0ZXN0IHN0YXRpc3RpYyBpcyB1c2VkClxbCiAgVCA9IFxmcmFje1NfMS1cdGV4dHtFfV97MH1cbGVmdFtTXzFccmlnaHRdfXtcc3FydHtcdGV4dHtWYXJ9X3swfVxsZWZ0W1NfMVxyaWdodF19fSwKXF0KCi0gd2l0aCAkXHRleHR7RX1fezB9XGxlZnRbU18xXHJpZ2h0XSQgYW5kICRcdGV4dHtWYXJ9X3swfVxsZWZ0W1NfMVxyaWdodF0kIHRoZSBleHBlY3QgbWVhbiBhbmQgdmFyaWFuY2Ugb2YgUzEgdW5kZXIgJEhfMCQuCgotIFVuZGVyICRIXzAkCiBcWwogICBcdGV4dHtFfV97MH1cbGVmdFtTXzFccmlnaHRdPSBcZnJhY3sxfXsyfW5fMShuKzEpIFw7XDtcO1w7XHRleHR7IGVuIH1cO1w7XDtcOyBcdGV4dHtWYXJ9X3swfVxsZWZ0W1NfMVxyaWdodF09XGZyYWN7MX17MTJ9bl8xbl8yKG4rMSkuCiBcXQoKLSBVbmRlciAkSF8wJCBhbmQgd2hlbiAkXG1pbihuXzEsbl8yKVxyaWdodGFycm93IFxpbmZ0eSQKIFxbCiAgICBUID0gXGZyYWN7U18xLVx0ZXh0e0V9X3swfVxsZWZ0W1NfMVxyaWdodF19e1xzcXJ0e1x0ZXh0e1Zhcn1fezB9XGxlZnRbU18xXHJpZ2h0XX19IFxyaWdodGFycm93IE4oMCwxKS4KIFxdCgpBc3ltcHRvdGljYWxseSB0aGUgc3RhbmRhcmRpc2VkIHN0YXRpc3RpYyBmb2xsb3dzIGEgc3RhbmRhcmQgbm9ybWFsIGRpc3RyaWJ1dGlvbiEKCi0tLQoKIyMgQ2hvbGVzdGVyb2wgZXhhbXBsZQoKV2UgaWxsdXN0cmF0ZSB0aGUgcmVzdWx0IGZvciB0aGUgY2hvbGVzdGVyb2wgZXhhbXBsZSB1c2luZyB0aGUgUiBmdW5jdGlvbiBgd2lsY294LnRlc3RgLgoKYGBge3J9CndpbGNveC50ZXN0KGNob2xlc3QgfiBncm91cCwgZGF0YSA9IGNob2wpCmBgYAoKLSBXZSByZWplY3QgJEhfMCQgKCRwPSQgYHIgZm9ybWF0KHdpbGNveC50ZXN0KGNob2xlc3R+Z3JvdXAsZGF0YT1jaG9sKSRwLnZhbHVlLGRpZ2l0cz0yKWAgJDwwLjA1JCkKCi0gVGhlIG91dHB1dCBzaG93cyAkVz0kIGByIHdpbGNveC50ZXN0KGNob2xlc3R+Z3JvdXAsZGF0YT1jaG9sKSRzdGF0aXN0aWNgPwoKLSBMZXRzIGNhbGN1bGF0ZQpgYGB7cn0KUzEgPC0gY2hvbCAlPiUgCiAgICBtdXRhdGUocmFua3MgPSByYW5rKGNob2xlc3QpKSAlPiUKICAgIGZpbHRlcihncm91cCA9PSAxKSAlPiUgCiAgICBwdWxsKHJhbmtzKSAlPiUKICAgIHN1bSAKUzEKUzIgPC0gY2hvbCAlPiUgCiAgICBtdXRhdGUocmFua3MgPSByYW5rKGNob2xlc3QpKSAlPiUKICAgIGZpbHRlcihncm91cCA9PSAyKSAlPiUgCiAgICBwdWxsKHJhbmtzKSAlPiUKICAgIHN1bSAKUzIKYGBgCgotIFdoZXJlIGRvZXMgJFc9JCBgciB3aWxjb3gudGVzdChjaG9sZXN0fmdyb3VwLGRhdGE9Y2hvbCkkc3RhdGlzdGljYCBjb21lcyBmcm9tPwoKLS0tCgojIyBNYW5uIGFuZCBXaGl0bmV5IHRlc3QKCk1hbm4gYW5kIFdoaXRuZXkgdGVzdCBpbiBhYnNlbmNlIG9mIHRpZXM6ClxbCiBVXzEgPSBcc3VtX3tpPTF9XntuXzF9XHN1bV97az0xfV57bl8yfSBcdGV4dHtJfVxsZWZ0XHtZX3tpMX1cZ2VxIFlfe2syfVxyaWdodFx9LgpcXQoKLSB3aXRoICRcdGV4dHtJfVxsZWZ0XHsuXHJpZ2h0XH0kIGFuIGluZGljYXRvciB0aGF0IGVxdWFscyAxICBpZiB0aGUgZXhwcmVzc2lvbiBpcyB0cnVlIGFuZCBpcyB6ZXJvIG90aGVyd2lzZS4KCi0gVSBjb3VudHMgaG93IG1hbnkgdGltZXMgYW4gb2JzZXJ2YXRpb24gb2YgdGhlIGZpcnN0IGdyb3VwIGlzIGxhcmdlciBvciBlcXVhbCB0byBhbiBvYnNlcnZhdGlvbiBmcm9tIHRoZSBzZWNvbmQgZ3JvdXAuCgpgYGB7cn0KeTEgPC0gY2hvbCAlPiUgCiAgICBmaWx0ZXIoZ3JvdXAgPT0gMSkgJT4lIAogICAgcHVsbChjaG9sZXN0KQoKeTIgPC0gY2hvbCAlPiUgCiAgICBmaWx0ZXIoZ3JvdXAgPT0gMikgJT4lIAogICAgcHVsbChjaG9sZXN0KQoKdTFIbHAgPC0gc2FwcGx5KHkxLCBmdW5jdGlvbih5MWksIHkyKSB7CiAgeTFpID49IHkyCn0sIHkyID0geTIpCmNvbG5hbWVzKHUxSGxwKSA8LSB5MQpyb3duYW1lcyh1MUhscCkgPC0geTIKYGBgCgpgYGB7cn0KdTFIbHAKVTEgPC0gc3VtKHUxSGxwKQpVMQpgYGAKCkl0IGNhbiBiZSBzaG93biB0aGF0ICRVXzEgPSBTXzEgLSBcZnJhY3sxfXsyfW5fMShuXzErMSkuJAoKYGBge3J9ClMxIC0gbkdyb3Vwc1sxXSAqIChuR3JvdXBzWzFdICsgMSkgLyAyCmBgYAoKMS4gJFVfMSQgZW4gJFNfMSQgY29udGFpbiB0aGUgc2FtZSBpbmZvcm1hdGlvbgoyLiAkVV8xJCBpcyBhbHNvIGEgcmFuayBzdGF0aXN0aWMsIGFuZAozLiBFeGFjdCB0ZXN0IGJhc2VkIG9uICRVXzEkIGFuZCAkU18xJCBhcmUgZXF1aXZhbGVudC4KCi0tLQoKIyMgUHJvYmFiaWxpc3RpYyBpbmRleAoKLSAkVV8xJCBoYXMgYSBiZXR0ZXIgaW50ZXJwcmV0YXRpb24gZmVhdHVyZQotIExldCAkWV9qJCBhIHJhbmRvbSBvYnNlcnZhdGlvbiBmcm9tIGdyb3VwICRqJCAoJGo9MSwyJCkuIFRoZW4KXGJlZ2lue2VxbmFycmF5Kn0KICBcZnJhY3sxfXtuXzFuXzJ9XHRleHR7RX1cbGVmdFtVXzFccmlnaHRdCiAgICAgJj0mIFx0ZXh0e1B9XGxlZnRbWV8xIFxnZXEgWV8yXHJpZ2h0XS4KXGVuZHtlcW5hcnJheSp9CgpTbyB3ZSBjYW4gZXN0aW1hdGUgdGhlIHByb2JhYmlsaXR5IGJ5IGNhbGN1bGF0aW5nIHRoZSBtZWFuIG9mIGFsbCBpbmRpY2F0b3IgdmFyaWFibGUgdmFsdWVzICRcdGV4dHtJfVxsZWZ0XHtZX3tpMX1cZ2VxIFlfe2syfVxyaWdodFx9JC4gTm90ZSwgdGhhdCB3ZSBkaWQgJG5fMSBcdGltZXMgbl8yJCBjb21wYXJpc29ucwoKYGBge3J9Cm1lYW4odTFIbHApClUxIC8gKG5Hcm91cHNbMV0gKiBuR3JvdXBzWzJdKQpgYGAKCi0gUHJvYmFiaWxpdHkgJFx0ZXh0e1B9XGxlZnRbWV8xIFxnZXEgWV8yXHJpZ2h0XSQgaXMgcmVmZXJyZWQgdG8gYXMgdGhlICpwcm9iYWJpbGlzdGljIGluZGV4Ki4KLSBJdCBpcyB0aGUgcHJvYmFiaWxpdHkgdGhhdCBhIHJhbmRvbSBvYnNlcnZhdGlvbiBvZiB0aGUgZmlyc3QgZ3JvdXAgaXMgbGFyZ2VyIG9yIGVxdWFsIHRoYW4gYSByYW5kb20gb2JzZXJ2YXRpb24gb2YgdGhlIHNlY29uZCBncm91cAotIElmICRIXzAkIGhvbGRzICRcdGV4dHtQfVxsZWZ0W1lfMSBcZ2VxIFlfMlxyaWdodF09XGZyYWN7MX17Mn0kLgoKLSBSIGZ1bmN0aW9uIGB3aWxjb3gudGVzdGAgZG9lcyBub3QgcmV0dXJuIHRoZSBXaWxjb3hvbiByYW5rIHN1bSBzdGF0aXN0aWMuIEl0IHJldHVybnMgdGhlIE1hbm4tV2hpdG5leSBzdGF0aXN0aWMgJFVfMSQuCi0gTGV0cyByZXZpc2l0IHRoZSByZXN1bHQKYGBge3J9CndUZXN0IDwtIHdpbGNveC50ZXN0KGNob2xlc3QgfiBncm91cCwgZGF0YSA9IGNob2wpCndUZXN0ClUxCnByb2JJbmQgPC0gd1Rlc3Qkc3RhdGlzdGljIC8gcHJvZChuR3JvdXBzKQpwcm9iSW5kCmBgYAoKQmVjYXVzZSAkcD0kIGByIGZvcm1hdCh3VGVzdCRwLnZhbHVlLGRpZ2l0cz0zKWAgJDwwLjA1JCB3ZSBjb25jbHVkZSBhdCB0aGUgJDVcJSQgc2lnbmlmaWNhbmNlIGxldmVsIHRoYXQgdGhlIG1lYW4gY2hvbGVzdGVyb2wgbGV2ZWwgb2YgaGFydCBwYXRpZW50cyBpcyBsYXJnZXIgdGhlbiB0aGF0IG9mIGhlYWx0aHkgc3ViamVjdHMuCgogIC0gTm90ZSB0aGF0IHdlIGhhdmUgYXNzdW1lZCB0aGF0IHRoZSBsb2NhdGlvbi1zaGlmdCBtb2RlbCBpcyB2YWxpZCBpbiB0aGlzIGNvbmNsdXNpb24uCiAgLSBXZSBhbHNvIGtub3cgdGhhdCBoaWdoZXIgY2hvbGVzdGVyb2wgbGV2ZWwgYXJlIG1vcmUgbGlrZWx5IGZvciBoYXJ0IHBhdGllbnRzIHRoZW4gZm9yIGhlYWx0aHkgc3ViamVjdHMgYW5kIHRoaXMgcHJvYmFiaWxpdHkgaXMKJFUxLyhuXzFcdGltZXMgbl8yKT0kIGByIHByb2JJbmQqMTAwYCUuCiAgLSBXZSBzaG91bGQgYXNzZXNzIHRoZSBsb2NhdGlvbiBzaGlmdCBhc3N1bXB0aW9uLiBCdXQgdGhpcyBpcyBub3QgcG9zc2libGUgd2l0aCBvbmx5IDUgb2JzZXJ2YXRpb25zLgoKV2l0aG91dCB0aGUgbG9jYXRpb24tc2hpZnQgYXNzdW1wdGlvbiB0aGUgY29uY2x1c2lvbiBpbiB0ZXJtcyBvZiB0aGUgcHJvYmFiaWxpc3RpYyBpbmRleCByZW1haW5zIHZhbGlkIQoKICAtIFNvIHdoZW4gd2UgZG8gbm90IGFzc3VtZSBsb2NhdGlvbiBzaGlmdCB3ZSB0ZXN0IGZvcgoKXFtIXzA6IEZfMT1GXzIgXHRleHR7IHZzIH0gSF8xOiBQW1lfMSBcZ2VxIFlfMl0gXG5lcSAwLjUuXF0KCgojIyBDb25jbHVzaW9uCgpUaGVyZSBpcyBhIHNpZ25pZmljYW50IGRpZmZlcmVuY2UgaW4gdGhlIGRpc3RyaWJ1dGlvbiBvZiB0aGUgY2hvbGVzdGVyb2wgY29uY2VudHJhdGlvbiBvZiBoYXJ0IHBhdGllbnRzIHR3byBkYXlzIHVwb24gYSBzdHJva2UgYW5kIHRoYXQgb2YgaGVhbHRoeSBzdWJqZWN0ICgkcD0kIGByIGZvcm1hdCh3VGVzdCRwLnZhbHVlLGRpZ2l0cz0zKWApLiBJdCBpcyBtb3JlIGxpa2VseSB0byBvYnNlcnZlIGhpZ2hlciBjaG9sZXN0ZXJvbCBsZXZlbHMgZm9yIGhhcnQgcGF0aWVudHMgdGhlbiBmb3IgaGVhbHRoeSBzdWJqZWN0cy4gVGhlIHBvaW50IGVzdGltYXRvciBmb3IgdGhpcyBwcm9iYWJpbGl0eSBpcyBgciBwcm9iSW5kKjEwMGAlLgoKCiMgQ29tcGFyaXNvbiBvZiAkZyQgZ3JvdXBzCgotIEV4dGVuZCAgJEYkLXRlc3QgZnJvbSBhIG9uZS13YXkgQU5PVkEgdG8gbm9uLXBhcmFtZXRyaWMgYWx0ZXJuYXRpdmVzLgoKIyBETUggZXhhbXBsZQoKQXNzZXNzIGdlbm90b3hpY2l0eSBvZiAxLDItZGltZXRoeWxoeWRyYXppbmUgZGloeWRyb2NobG9yaWRlIChETUgpICAoRVUgZGlyZWN0aXZlKQoKLSAyNCByYXRzCi0gZm91ciBncm91cHMgd2l0aCBkYWlseSBETUggZG9zZQogIC0gY29udHJvbAogIC0gbG93CiAgLSBtZWRpdW0KICAtIGhpZ2gKCi0gR2Vub3RveGljaXR5IGluIGxpdmVyIHVzaW5nIGNvbWV0IGFzc2F5IG9uIDE1MCBsaXZlciBjZWxscyBwZXIgcmF0LgotIEFyZSB0aGVyZSBkaWZmZXJlbmNlcyBpbiBETkEgZGFtYWdlIGR1ZSB0byBETUggZG9zZT8KCiMjIENvbWV0IEFzc2F5OgoKLSBWaXN1YWxpc2UgRE5BIHN0cmFuZCBicmVha3MKLSBMZW5ndGggY29tZXQgdGFpbCBpcyBhIHByb3h5IGZvciBzdHJhbmQgYnJlYWtzLgoKIVtDb21ldCBhc3NheV0oaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0dUUEIvUFNMUzIwL2doLXBhZ2VzL2Fzc2V0cy9maWdzL2NvbWV0LmpwZyl7IHdpZHRoPTUwJSB9CgoKYGBge3J9CmRuYSA8LSByZWFkX2RlbGltKCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vR1RQQi9QU0xTMjAvbWFzdGVyL2RhdGEvZG5hLnR4dCIsIGRlbGltID0gIiAiKQpkbmEkZG9zZSA8LSBhcy5mYWN0b3IoZG5hJGRvc2UpCmRuYQpgYGAKCgpgYGB7cn0KZG5hICU+JQogIGdncGxvdChhZXMoeCA9IGRvc2UsIHkgPSBsZW5ndGgsIGZpbGwgPSBkb3NlKSkgKwogIGdlb21fYm94cGxvdCgpICsKICBnZW9tX3BvaW50KHBvc2l0aW9uID0gImppdHRlciIpCgpkbmEgJT4lCiAgZ2dwbG90KGFlcyhzYW1wbGUgPSBsZW5ndGgpKSArCiAgZ2VvbV9xcSgpICsKICBnZW9tX3FxX2xpbmUoKSArCiAgZmFjZXRfd3JhcCh+ZG9zZSkKYGBgCgotIFN0cm9uZyBpbmRpY2F0aW9uIHRoYXQgZGF0YSBpbiBjb250cm9sIGdyb3VwIGhhcyBhIGxvd2VyIHZhcmlhbmNlLgotIDYgb2JzZXJ2YXRpb25zIHBlciBncm91cCBhcmUgdG9vIGZldyB0byBjaGVjayB0aGUgYXNzdW1wdGlvbnMKCmBgYHtyfQpwbG90KGxtKGxlbmd0aCB+IGRvc2UsIGRhdGEgPSBkbmEpKQpgYGAKCiMgS3J1c2thbC1XYWxsaXMgUmFuayBUZXN0CgotIFRoZSBLcnVza2FsLVdhbGxpcyBSYW5rIFRlc3QgKEtXLXRlc3QpIGlzIGEgIG5vbi1wYXJhbWV0ZXJpYyBhbHRlcm5hdGl2ZSAgZm9yIEFOT1ZBIEYtdGVzdC4KCi0gIENsYXNzaWNhbCAkRiQtdGVzdHN0YXRpc3RpYyBjYW4gYmUgd3JpdHRlbiBhcwogIFxbCiAgICBGID0gXGZyYWN7XHRleHR7U1NUfS8oZy0xKX17XHRleHR7U1NFfS8obi1nKX0gPSBcZnJhY3tcdGV4dHtTU1R9LyhnLTEpfXsoXHRleHR7U1NUb3R9LVx0ZXh0e1NTVH0pLyhuLWcpfSAsCiAgXF0KLSAgd2l0aCAkZyQgdGhlIG51bWJlciBvZiBncm91cHMuCgotIFNTVG90IGRlcGVuZHMgb25seSBvbiAgb3V0Y29tZXMgJFxtYXRoYmZ7eX0kIGFuZCB3aWxsIG5vdCB2YXJ5IGluIHBlcm11dGF0aW9uIHRlc3QuCgotIFNTVCBjYW4gYmUgdXNlZCBhcyBzdGF0aXN0aWMKICQkXHRleHR7U1NUfT1cc3VtX3tqPTF9XnQgbl9qKFxiYXJ7WX1fai1cYmFye1l9KV4yJCQKCgotICBUaGUgS1cgdGVzdCBzdGF0aXN0aWMgaXMgYmFzZWQgb24gU1NUIG9uIHJhbmstdHJhbnNmb3JtZWQgb3V0Y29tZXNeW3dlIGFzc3VtZSB0aGF0IG5vICp0aWVzKiBhcmUgYXZhaWxhYmxlXSwKICBcWwogICAgIFx0ZXh0e1NTVH0gPSBcc3VtX3tqPTF9Xmcgbl9qIFxsZWZ0KFxiYXJ7Un1faiAtIFxiYXJ7Un1ccmlnaHQpXjIgPSBcc3VtX3tqPTF9XnQgbl9qIFxsZWZ0KFxiYXJ7Un1faiAtIFxmcmFje24rMX17Mn1ccmlnaHQpXjIgLAogIFxdCi0gIHdpdGggJFxiYXJ7Un1faiQgdGhlIG1lYW4gb2YgdGhlIHJhbmtzIGluIGdyb3VwICRqJCwgYW5kICRcYmFye1J9JCB0aGUgbWVhbiBvZiBhbGwgcmFua3MsCiAgXFsKICAgIFxiYXJ7Un0gPSBcZnJhY3sxfXtufSgxKzIrXGNkb3RzICsgbikgPSBcZnJhY3sxfXtufVxmcmFjezF9ezJ9bihuKzEpID0gXGZyYWN7bisxfXsyfS4KICBcXQotICBUaGUgS1cgdGVzdHN0YXRpc3RpYyBpcyBnaXZlbiBieQogIFxbCiAgICBLVyA9IFxmcmFjezEyfXtuKG4rMSl9ICBcc3VtX3tqPTF9Xmcgbl9qIFxsZWZ0KFxiYXJ7Un1faiAtIFxmcmFje24rMX17Mn1ccmlnaHQpXjIuCiAgXF0KLSAgVGhlIGZhY3RvciAkXGZyYWN7MTJ9e24obisxKX0kIGlzIHVzZWQgc28gdGhhdCAkS1ckIGhhcyBhIHNpbXBsZSBhc3ltcHRvdGljIG51bGwgZGlzdHJpYnV0aW9uLiBJbiBwYXJ0aWN1bGFyIHVuZGVyICRIXzAkLCBnaXZlbiB0aGFydCAkXG1pbihuXzEsXGxkb3RzLCBuX2cpXHJpZ2h0YXJyb3cgXGluZnR5JCwKICBcWwogICAgS1cgIFxyaWdodGFycm93IFxjaGleMl97dC0xfS4KICBcXQoKLSAgVGhlIGV4YWN0IEtXLXRlc3QgY2FuIGJlIGV4ZWN1dGVkIGJ5IGNhbGN1bGF0aW5nIHRoZSBwZXJtdXRhdGlvbiBudWxsIGRpc3RyaWJ1dGlvbiAodGhhdCBvbmx5IGRlcGVuZHMgb24gJG5fMSwgXGxkb3RzLCBuX2ckKSB0byB0ZXN0CiAgJCRIXzA6IGZfMT1cbGRvdHM9Zl9nIFx0ZXh0eyB2cyB9IEhfMTogXHRleHR7IGF0IGxlYXN0IHR3byBtZWFucyBhcmUgZGlmZmVyZW50fS4kJAoKLSBJbiBvcmRlciB0byBhbGxvdyAkSF8xJCB0byBiZSBmb3JtdWxhdGVkIGluIHRlcm1zIG9mIG1lYW5zLCB0aGUgYXNzdW1wdGlvbiBvZiBsb2NhdGlvbnMgc2hpZnQgc2hvdWxkIGJlIHZhbGlkLgotIEZvciBETUggZXhhbXBsZSB0aGlzIGlzIG5vdCB0aGUgY2FzZS4KLSBJZiBsb2NhdGlvbi1zaGlmdCBpcyBpbnZhbGlkLCB3ZSBoYXZlIHRvIGZvcm11bGF0ZSAkSF8xJCBpbiB0ZXJtcyBvZiBwcm9iYWJpbGlzdGljIGluZGljZXM6CiAgJCRIXzA6IGZfMT1cbGRvdHM9Zl9nIFx0ZXh0eyB2cyB9IEhfMTogXGV4aXN0c1wgaixrIFxpbiBcezEsXGxkb3RzLGdcfSA6IFx0ZXh0e1B9XGxlZnRbWV9qXGdlcSBZX2tccmlnaHRdXG5lcSAwLjUkJAoKCiMjIEROQSBEYW1hZ2UgRXhhbXBsZQoKYGBge3J9CmtydXNrYWwudGVzdChsZW5ndGggfiBkb3NlLCBkYXRhID0gZG5hKQpgYGAKCi0gT24gdGhlICQ1XCUkIGxldmVsIG9mIHNpZ25pZmljYW5jZSB3ZSBjYW4gcmVqZWN0IHRoZSBudWxsIGh5cG90aGVzaXMuCgotIFItZnVuY3RpZSBga3J1c2thbC50ZXN0YCBvbmx5IHJldHVybnMgdGhlIGFzeW1wdG90aWMgYXBwcm94aW1hdGlvbiBmb3IgJHAkLXZhbHVlcy4KCi0gV2l0aCBvbmx5IDYgb2JzZXJ2YXRpZXMgcGVyIGdyb2VwLCB0aGlzIGlzIG5vdCBhIGdvb2QgYXBwcm94aW1hdGlvbiBvZiB0aGUgJHAkLXZhbHVlCgotICBXaXRoIHRoZSBgY29pbmAgUiBwYWNrYWdlIHdlIGNhbiBjYWxjdWxhdGUgdGhlIGV4YWN0ZSAkcCQtdmFsdWUKCmBgYHtyLHdhcm5pbmc9RkFMU0UsbWVzc2FnZT1GQUxTRX0KbGlicmFyeShjb2luKQprd1Blcm0gPC0ga3J1c2thbF90ZXN0KGxlbmd0aCB+IGRvc2UsCiAgZGF0YSA9IGRuYSwKICBkaXN0cmlidXRpb24gPSBhcHByb3hpbWF0ZShCID0gMTAwMDAwKQopCmt3UGVybQpgYGAKCi0gV2UgY29uY2x1ZGUgdGhhdCB0aGUgZGlmZmVyZW5jZSBpbiB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBETkEgZGFtYWdlcyBkdWUgdG8gdGhlIERNSCBkb3NlIGlzIGV4dHJlbWVseSBzaWduaWZpY2FudGx5IGRpZmZlcmVudC4KCi0gUG9zdGhvYyBhbmFseXNpcyB3aXRoIFdNVyB0ZXN0cy4KCmBgYHtyfQpwYWlyd2lzZS53aWxjb3gudGVzdChkbmEkbGVuZ3RoLCBkbmEkZG9zZSkKYGBgCgotIEFsbCBETUggYmVoYW5kZWxpbmdlbiBhcmUgc2lnbmlmaWNhbnRseSBkaWZmZXJlbnQgZnJvbSB0aGUgY29udHJvbC4KLSBUaGUgRE1IIGFyZSBub3Qgc2lnbmlmaWNhbnRseSBkaWZmZXJlbnQgZnJvbSBvbmUgYW5vdGhlci4KLSBVMSBkb2VzIG5vdCBvY2N1ciBpbiB0aGUgYHBhaXJ3aXNlLndpbGNveC50ZXN0YCBvdXRwdXQuIFBvaW50IGVzdGltYXRlIG9uIHByb2JhYmlsaXR5IG9uIGhpZ2hlciBETkEtZGFtYWdlPwoKYGBge3IsIGVjaG89RkFMU0V9CnBhaXJXaWxjb3ggPC0gcGFpcndpc2Uud2lsY294LnRlc3QoZG5hJGxlbmd0aCwgZG5hJGRvc2UpCmBgYAoKYGBge3J9Cm5Hcm91cCA8LSB0YWJsZShkbmEkZG9zZSkKcHJvYkluZCA8LSBjb21ibihsZXZlbHMoZG5hJGRvc2UpLCAyLCBmdW5jdGlvbih4KSB7CiAgdGVzdCA8LSB3aWxjb3gudGVzdChsZW5ndGggfiBkb3NlLCBzdWJzZXQoZG5hLCBkb3NlICVpbiUgeCkpCiAgcmV0dXJuKHRlc3Qkc3RhdGlzdGljIC8gcHJvZChuR3JvdXBbeF0pKQp9KQpuYW1lcyhwcm9iSW5kKSA8LSBjb21ibihsZXZlbHMoZG5hJGRvc2UpLCAyLCBwYXN0ZSwgY29sbGFwc2UgPSAidnMiKQpwcm9iSW5kCmBgYAoKQmVjYXVzZSB0aGVyZSBhcmUgZG91YnRzIG9uIHRoZSBsb2NhdGlvbi1zaGlmdCBtb2RlbCB3ZSBkcmF3IG91ciBjb25jbHVzaW9ucyBpbiB0ZXJtcyBvZiB0aGUgcHJvYmFiaWxpc3RpYyBpbmRleC4KCiMjIyBDb25jbHVzaW9uCgotIFRoZXJlIGlzIGFuIGV4dHJlbWVseSBzaWduaWZpY2FudCBkaWZmZXJlbmNlIGluIGluIHRoZSBkaXN0cmlidXRpb24gb2YgdGhlIEROQS1kYW1hZ2UgbWVhc3VyZW1lbnRzIGR1ZSB0byB0aGUgdHJlYXRtZW50IHdpdGggRE1IICAoJHA8MC4wMDEkIEtXLXRlc3QpLgotIEROQS1kYW1hZ2UgaXMgbW9yZSBsaWtlbHkgdXBvbiBETUggdHJlYXRtZW50IHRoYW4gaW4gdGhlIGNvbnRyb2wgdHJlYXRtZW50IChhbGwgcD0wLjAxMywgV01XLXRlc3RlbikuCi0gVGhlIHByb2JhYmlsaXR5IG9uIGhpZ2hlciBETkEtZGFtYWdlIHVwb24gZXhwb3N1cmUgdG8gRE1IIGlzIDEwMCUgKENhbGN1bGF0aW9uIG9mIGEgQ0kgb24gdGhlIHByb2JhYmlsaXN0aWMgaW5kZXggaXMgYmV5b25kIHRoZSBzY29wZSBvZiB0aGUgY291cnNlKQotIFRoZXJlIGFyZSBubyBzaWduaWZpY2FudCBkaWZmZXJlbmNlcyBpbiB0aGUgZGlzdHJpYnV0aW9ucyBvZiB0aGUgY29taXQtbGVuZ3RocyBhbW9uZyB0aGUgdHJlYXRtZW50IHdpdGggdGhlIGRpZmZlcmVudCBETUggY29uY2VudHJhdGlvbnMgKCRwPSQgYHIgcGFzdGUoZm9ybWF0KHJhbmdlKHBhaXJXaWxjb3gkcC52YWx1ZVssLTFdLG5hLnJtPVRSVUUpLGRpZ2l0PTIpLGNvbGxhcHNlPSItIilgKS4KLSBETUggc2hvd3MgYWxyZWFkeSBnZW5vdG94aWMgZWZmZWN0cyBhdCBsb3cgZG9zZS4KLSAoQWxsIHBhaXJ3aXNlIHRlc3RzIGFyZSBjb3JyZWN0ZWQgZm9yIG11bHRpcGxlIHRlc3RpbmcgdXNpbmcgSG9sbSdzIG1ldGhvZCkuCgojIFByb2JhYmlsaXN0aWMgaW5kZXggbW9kZWxzIChQSU0pCgotIEluIHRoZSBsYXN0IGRlY2FkZSB3ZSBkZXZlbG9wZWQgUElNIG1vZGVscyBhdCBHaGVudCBVbml2ZXJzaXR5CgotIFBJTSBnZW5lcmFsaXNlcyB0aGUgV2lsY294b24tTWFubl9XaXRobmV5IGFuZCBLcnVza2FsIFdhbGxpcyB0ZXN0cyB0b3dhcmRzIGEgcmVncmVzc2lvbiBmcmFtZXdvcmsgZm9yIHRoZSBwcm9iYWJpbGlzdGljIGluZGV4LiAKCi0gUElNIHByb3ZpZGVzIGEgbm9ucGFyYW1ldHJpYyByZWdyZXNzaW9uIGZyYW1ld29yayBmb3IgZXhwZXJpbWVudHMgd2l0aCBzaW1wbGUgYW5kIGNvbXBsZXggZXhwZXJpbWVudGFsIGRlc2lnbnMuIAoKLSBUaGFzLCBPLiwgRGVuZXZlLCBKLiwgQ2xlbWVudCwgTC4gJiBPdHRveSwgSi5QLiAoMjAxMikuIFByb2JhYmlsaXN0aWMgSW5kZXggTW9kZWxzLiBKb3VybmFsIG9mIHRoZSBSb3lhbCBTb2NpZXR5IFNlcmllcyBCIChTdGF0aXN0aWNhbCBNZXRob2RvbG9neSksIDc0KDQpOiA2MjMtNjcxLiAgRE9JOiAxMC4xMTExL2ouMTQ2Ny05ODY4LjIwMTEuMDEwMjAueAoKLSBEZSBOZXZlLCBKLiAmIFRoYXMsIE8uICgyMDE1KS4gQSBSZWdyZXNzaW9uIEZyYW1ld29yayBmb3IgUmFuayBUZXN0cyBCYXNlZCBvbiB0aGUgUHJvYmFiaWxpc3RpYyBJbmRleCBNb2RlbCwgSm91cm5hbCBvZiB0aGUgQW1lcmljYW4gU3RhdGlzdGljYWwgQXNzb2NpYXRpb24sIDExMDo1MTEsIDEyNzYtMTI4MywgRE9JOiAxMC4xMDgwLzAxNjIxNDU5LjIwMTUuMTAxNjIyNgoKCi0gQW1vcmltIEcuIGV0IGFsLiAoMjAxOCkuIFNtYWxsIHNhbXBsZSBpbmZlcmVuY2UgZm9yIHByb2JhYmlsaXN0aWMgaW5kZXggbW9kZWxzLiBDb21wdXRhdGlvbmFsIFN0YXRpc3RpY3MgJiBEYXRhIEFuYWx5c2lzLCAxMjE6MTM3LTE0OC4gIERPSTogMTAuMTAxNi9qLmNzZGEuMjAxNy4xMS4wMDUKCi0gRGUgU2NocmlqdmVyLCBNLiBhbmQgRGUgTmV2ZSwgSi4gKDIwMTkpIEEgdHV0b3JpYWwgb24gcHJvYmFiaWxpc3RpYyBpbmRleCBtb2RlbHM6IFJlZ3Jlc3Npb24gbW9kZWxzIGZvciB0aGUgZWZmZWN0IHNpemUgUChZMSA8IFkyKS4gUHN5Y2hvbG9naWNhbCBNZXRob2RzLCAyNCg0KSwgNDAz4oCTNDE4LiBET0k6IDEwLjEwMzcvbWV0MDAwMDE5NAoKLSAuLi4=</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("02-ranktests.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
